{"title":"Weekly Discussion","markdown":{"yaml":{"description":"Summary about the progress and issues in the week","output-file":"weekly.html","title":"Weekly Discussion"},"headingText":"05/04/2022","containsRefs":false,"markdown":"\n\n\n\n<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->\n\n- Calculate LOD score under a range of afreq\n- runPM on top HLOD variants\n\n## 04/27/2022\n- format vcf to runPM input (chr22; afreq cutoff 0.01) (https://github.com/changebio/alzheimers-family/blob/master/notebook/20220426_Format_vcf_to_runPM_input.ipynb)\n- calculate LODs for different population by plug in allele freq from annotation file (AF, not population AF) (https://github.com/changebio/alzheimers-family/blob/master/notebook/20220426_Result_summary_R.ipynb)\n- compare AF between annotation and vcf\n- compare the result between paramlink2 and mlink (https://github.com/changebio/SEQLinkage/blob/master/nbs/paramlink2vsmlink.ipynb)\n\n===\n- The manhattan plots of different population with afreq=0.5\n- The informative families and allele freq in HLOD result\n- The founder percentage in different population\n- How paramlink2 break loops?\n- Read rvnpl papers\n\n## 04/20/2022\n- genome wide linkage analysis\n- format genotype data\n- plug in allele freq from annotation file\n- calculate LODs for different population\n\n## 04/13/2022\n- Format CHP output for runPM\n- Test runPM\n- linkage heterogeneity\n    - The number of significant variants increases. \n- linkage analysis without haplotype imputation\n\n## 04/06/2022\n- Format CHP output for runPM\n- Test runPM\n- Maximize the likelihood using grid search method\n- Run linakge analysis of common variants on all chromosomes\n\n## 03/30/2022\n- Maximize the likelihood using grid search method\n- Run linakge analysis of common variants on all chromosomes\n- Check recombination on gene TPTEP1\n\nSome thoughts to reduce recombination\n1. filter common variants before phasing\n2. filter variants only occurred once in a family (singleton) before phasing\n3. remove families with recombination more than 3\n\n- TPTEP1\n    - 989 family: 31 -> 19 -> 3\n    - <3 recombination 0.49 -> 0.82\n\nQ:\nrecombination and CHP markers (pseudomarker calculates the likelihood of a marker from all the data joinly)\n\n    - using recombination pattern accross all families \n\n## 03/23/2022\n- Build seqlink and paramlink2 sos pipeline for linkage analysis\n- Run linakge analysis on all chromosomes\n    - the results are promising (maybe still need to control type I errors)\n    - most of the significant variants (LOD>3) are rare variants.\n    - Using pseudomarker to do further analysis for variants with lod>3?(twostage.py)\n    - Verify results by previous studies (A list of genes or variants?)\n- Create pseudomarker input and test pseudomarker\n    - cannot handle mendelian errors in CHP markers (https://github.com/gaow/SEQLinkage/issues/41)\n        The reason is that recombination is setted as False to generate CHP markers.\n    - about 5 min per variant\n\nQ:\n\nrecombination and CHP markers (pseudomarker calculates the likelihood of a marker from all the data joinly)\n\n## 03/16/2022\n- Update multiprocessing to output the intermediate data\n    - qsub task killed (too many jobs or not enough memory?)\n- Build rpy2 pipeline for linkage analysis\n- Run linakge analysis on chromosomes\n- Remove unused parameters and codes in cstatgen.\n\n===\n- Fimpute https://animalbiosciences.uoguelph.ca/~msargol/fimpute/\n\nQuestions:\n- Using sos to run seqlink\n    - jobs\n    - for_each\n    - memory for each job or total\n\n- log odds pvalue distribution\n\n## 03/09/2022\nrun linkage analysis by paramlink2 on chr19 (APOE genes)\n\ncomparing lods under different dfreq and other model parameters (merlin model parameter AD 0.001 0.01,0.90,0.90 Dominant_Model)\n\ngenerate a pipeline to analysis multiple genes\n\n===\n\nplink vs plink2\n\ncommon variants\n\n## 03/03/2022\n\nmerlin model parameter\nAD 0.001   0.01,0.90,0.90 Dominant_Model\n- 1.[Is it reasonable to use marker freq as the population frequency of the disease allele?](https://github.com/gaow/SEQLinkage/issues/38)\n- 2.[How to integrate lods from different markers and in different families in the same gene?](https://github.com/gaow/SEQLinkage/issues/39)\n- 3.What is the cutoff of lod? Do we need to do adjust the threshold?\n\nWhy VCF QC is necessary?\nThe variant number is kind of the same as Yu's vcf.(need to do DP and GQ filtering) `/mnt/mfs/statgen/alzheimers-family/normalized_bed` \nThe variants are too dense to use lander-green algorithm.\n\nThe vcf file I used only has GT information in it.\n\nHow the vcf I used is matched with Yu's vcf? \n\n## 02/24/2022\n\n#### Progress\n\n##### SEQLinkage\nupdate multiple processing to speed up write linkage files  360 genes and 500 families using 10 hours to write as linkage (I/O bound problem)\n\nTake a look at Pseudomarker \n- https://www.jurgott.org/linkage/runPM.html\n- https://www.mv.helsinki.fi/home/tsjuntun/pseudomarker/download.html\n- https://www.ncbi.nlm.nih.gov/CBBresearch/Schaffer/fastlink.html\n\n\nOnly input and output file without run-linkage\n\n##### VCF_QC\nDouble check on the MAF being truly MAF\n\nRun VCF_QC under DP=2,\n\n```\nsos run ./pipeline/VCF_QC.ipynb qc    \\\n--genoFile /home/yh3455/xqtl-pipeline/ADSP_WES_geno_list.txt    \\\n--dbsnp-variants /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/00-All.add_chr.variants.gz  \\\n--reference-genome /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/GRCh38_full_analysis_set_plus_decoy_hla.noALT_noHLA_noDecoy_ERCC.fasta   \\\n--DP-snp 2 --DP-indel 2 \\\n--cwd /home/yh3455/Github/linkage/SEQpy3/data/genotype_all_dp2 --container /home/yh3455/Github/xqtl-pipeline/container/sifs/bioinfo.sif -J 22 --numThreads 10 --mem 128\n```\n\n> Check VCF QC\nhttp://mbontrager.org/blog/2016/08/17/Variant-Exploration\n\ntest on chr9 and chr22\n\n```\nsos run ./pipeline/VCF_QC.ipynb qc    --genoFile /home/yh3455/Github/xqtl-pipeline/ADSP_WES_geno_list1.txt    --dbsnp-variants /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/00-All.add_chr.variants.gz  --reference-genome /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/GRCh38_full_analysis_set_plus_decoy_hla.noALT_noHLA_noDecoy_ERCC.fasta   --DP-snp 2 --DP-indel 2 --cwd /home/yh3455/Github/linkage/SEQpy3/data/genotype_all_dp2_test --container /home/yh3455/Github/xqtl-pipeline/container/sifs/bioinfo.sif -J 22 --numThreads 10 --mem 128\n```\nremoving `bcftools filter -i 'GT=\"hom\" | TYPE=\"snp\" & GT=\"het\" & (FORMAT/AD[*:1])/(FORMAT/AD[*:0] + FORMAT/AD[*:1]) >= ${AB_snp} | TYPE=\"indel\" & GT=\"het\" & (FORMAT/AD[*:1])/(FORMAT/AD[*:0] + FORMAT/AD[*:1]) >= ${AB_indel}'`\n* 174325 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.leftnorm.filtered.vcf.gz\n\nremoving `bcftools filter -i 'GT=\"hom\" | TYPE=\"snp\" & GT=\"het\" & (FORMAT/AD[*:1])/(FORMAT/AD[*:0] + FORMAT/AD[*:1]) >= ${AB_snp} | TYPE=\"indel\" & GT=\"het\" & (FORMAT/AD[*:1])/(FORMAT/AD[*:0] + FORMAT/AD[*:1]) >= ${AB_indel}' | \\\n bcftools filter -i 'F_MISSING<${geno_filter} & HWE>${hwe_filter}'`\n* 277375 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.leftnorm.filtered.vcf.gz\n#### Questions and Issues\n1. What is the difference between merlin and mlink?\n\n---\n\n## 02/17/2022\n### 1. The format of daily PR\n- https://changebio.github.io/researchsummary/\n\n### 2. SEQLinkage\n\n#### Progress\n\n- Implement get AF from annotation.\n- Fix maf bug by reverse genotype if maf > 0.5. [A potential problem with calculating marker frequencies.](https://github.com/gaow/SEQLinkage/issues/33)\n- Fix output format and path bugs.\n- Update the command line script.\n- Running likange analysis on chr22\n\n===\n- Yu's data. VCF_QC has been done. Telled her the path of the data\n    * 170839 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.leftnorm.filtered.bim\n    * 174326 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.leftnorm.filtered.vcf.gz\n    * 368336 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.leftnorm.vcf.gz\n    * 368318 gcad.qc.r2.wes.chr9.20504.GATK.2020.06.26.biallelic.genotypes.ALL.vcf.gz\n\n```\nsos run ./pipeline/VCF_QC.ipynb qc    \\\n--genoFile /home/yh3455/xqtl-pipeline/ADSP_WES_geno_list     \\\n--dbsnp-variants /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/00-All.add_chr.variants.gz  \\\n--reference-genome /mnt/mfs/statgen/snuc_pseudo_bulk/data/reference_data/GRCh38_full_analysis_set_plus_decoy_hla.noALT_noHLA_noDecoy_ERCC.fasta   \\\n--cwd /home/yh3455/Github/linkage/SEQpy3/data/genotype_all --container /home/yh3455/Github/xqtl-pipeline/container/sifs/bioinfo.sif -J 22 --numThreads 10 --mem 128\n```\n\n\n\n\n#### Questions and Issues\n- 1.[the vcf file and the annotation file don't match](https://github.com/gaow/SEQLinkage/issues/34). \n[Can we get the variant id by VCFstream?](https://github.com/gaow/SEQLinkage/issues/35)\n> *add a get variant id function in cstatgen*\n> *https://github.com/statgenetics/cstatgen/blob/d51a06c18cd340fafe31e9b915ef9a2e49b55987/src/umich/vcf/VcfRecord.h*\n- 2.missing freq or 0 freq are assigned a MAF of (1-k)/2n. k is the fraction of singletons observed (need clarify). https://www.sciencedirect.com/science/article/pii/S0002929719303453\n> *add a new argument to deal with missing or 0 freq. default is to remove them. user can set an assigned MAF.*\n- 3.Do we need to do VCF QC for the family data?\n> * == further discussion is needed == *\n\n- 4.[Is the line to normalize allele freq to 1?](https://github.com/gaow/SEQLinkage/issues/32)\n\n![Screen Shot 2022-02-17 at 11.32.19 AM.png](attachment:432171f8-4650-4c0b-94fc-e2a93a989ad0.png)\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"weekly.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","theme":"cosmo","description":"Summary about the progress and issues in the week","title":"Weekly Discussion"},"extensions":{"book":{"multiFile":true}}}}}